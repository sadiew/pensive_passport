{% extends 'base.html' %}

{% block body %}
<h3>And the winner is....</h3>
<h1>{{ winner.name }}, {{winner.country}}</h1>
<div></div>
<div></div>
<table border="1">
    <thead>
        <tr>
            <th colspan="3">The Underlying Data</th>
        </tr> 
        <tr>
            <th>Variable</th>
            <th>{{ trip1.name }}</th>
            <th>{{ trip2.name }}</th>
        </tr>
    </thead>   
    <tbody>
        <tr>
            <td>Flight</td>
            <td>${{ '%.0f' %trip1.flights['total_fare'] }}</td>
            <td>${{ '%.0f' %trip2.flights['total_fare'] }}</td>
        </tr>
        <tr>
            <td>Weather</td>
            <td>{{ trip1.weather['low'] }} - {{ trip1.weather['high'] }} F</td>
            <td>{{ trip2.weather['low'] }} - {{ trip2.weather['high'] }} F</td>
        </tr>
        <tr>
            <td>Food</td>
            <td>{{ trip1.food[0] }} rest. / {{ trip1.food[1] }} *</td>
            <td>{{ trip2.food[0] }} rest. / {{ trip2.food[1] }} *</td>
        </tr>
        <tr>
            <td>Cost of Living</td>
            <td>{{ trip1.cost_of_living }}</td>
            <td>{{ trip2.cost_of_living }}</td>
        </tr>    
        <tr>
            <td>Wow Factor</td>
            <td>{{ trip1.wow_factor }}</td>
            <td>{{ trip2.wow_factor }}</td>
        </tr>    
    </tbody>
</table>

<p>
<button id="get-places-button">Explore {{ winner.name }} </button>
</p>
<div class="row">
    <div class="col-xs-4">
        <div id="restaurant-info"></div>
    </div>
    <div class="col-xs-4">
        <div id="museum-info"></div>
    </div>
    <div class="col-xs-4">
        <div id="park-info"></div>
    </div>
</div>

<script>
    
    function getPlaces(evt) {
        $.post( "/get-restaurants",
            { city: '{{winner.name}}', country: '{{winner.country}}'},
            function (result) {
                $('#restaurant-info').append("<h3>Restaurants</h3>");
                for (item in result) {
                    $('#restaurant-info').append("<p><a href=" + result[item] + ">" + item + "</a></p>");
                    };
                }
          );
        $.post( "/get-museums",
            { city: '{{winner.name}}', country: '{{winner.country}}'},
            function (result) { 
            $('#museum-info').append("<h3>Museums</h3>");
                for (item in result) {
                    $('#museum-info').append("<p><a href=" + result[item] + ">" + item + "</a></p>");
                    };
                }
          );
        $.post( "/get-parks",
            { city: '{{winner.name}}', country: '{{winner.country}}'},
            function (result) { 
            $('#park-info').append("<h3>Parks</h3>");
                for (item in result) {
                    $('#park-info').append("<p><a href=" + result[item] + ">" + item + "</a></p>");
                    };
                }
          );

    };

    $('#get-places-button').on('click', getPlaces);
</script>

{% endblock %}